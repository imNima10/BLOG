<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>پست‌های من</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/myPosts.css">
</head>

<body>
  <div class="blog-wrapper">
    <header class="blog-header">
      <h1>پست‌های من</h1>
      <div class="actions">
        <a href="/" class="btn home-btn">صفحه اصلی</a>
        <a href="/post/create" class="btn create-btn">ایجاد پست جدید</a>
        <a href="/user/me" class="btn profile-btn">پروفایل من</a>
      </div>
    </header>

    <main class="posts-container">
      <%if(posts.length){%>
        <%posts.forEach(post=>{%>
          <div class="post-card">
            <img src="<%=post.cover%>" alt="post cover">
            <div class="post-info">
              <h2>
                <%=post.title%>
              </h2>
              <p>
                <%=post.summary%>
              </p>
              <a href="/post/<%=post.slug%>" class="read-more">ادامه مطلب</a>
            </div>
          </div>
          <%})%>
            <% } else { %>
              <div class="no-posts">
                <img src="/images/empty.svg" alt="هیچ پستی نیست">
                <p>هنوز هیچ پستی منتشر نشده است.</p>
                <a href="/post/create" class="btn create-btn">اولین پست را ایجاد کنید</a>
              </div>
              <% } %>
    </main>
    <div class="pagination">
      <% if (pagination.page> 1) { %>
        <a href="/post/my/?page=<%= +pagination.page - 1 %>" class="page-btn prev">قبلی</a>
        <% } else { %>
          <span class="page-btn prev disabled">قبلی</span>
          <% } %>

            <div class="page-numbers">
              <% for (let i=1; i <=pagination.totalPage; i++) { %>
                <a href="/post/my/?page=<%= i %>" class="page-number <%= i === pagination.page ? 'active' : '' %>">
                  <%= i %>
                </a>
                <% } %>
            </div>

            <% if (pagination.page < pagination.totalPage) { %>
              <a href="/post/my/?page=<%= +pagination.page + 1 %>" class="page-btn next">بعدی</a>
              <% } else { %>
                <span class="page-btn next disabled">بعدی</span>
                <% } %>
    </div>
  </div>
  <script src="/js/sweetalert.js"></script>
  <script>
    if ("<%=locals.messages.success%>") {
      swal({
        title: "Success",
        text: "<%=locals.messages.success%>",
        icon: "success",
        button: "ok",
      })
    } else if ("<%=locals.messages.error%>") {
      swal({
        title: "Error",
        text: "<%=locals.messages.error%>",
        icon: "error",
        button: "try again",
      })
    } 
  </script>
</body>

</html>